# データをグルーピングできる

## 1. グルーピング

給与情報(salaries テーブル)から、従業員ごとに salary が何レコード登録されているかを取得し、従業員番号と登録レコード数を10件表示してください。

```sql
mysql> select emp_no ,count(*) as record_count from salaries GROUP BY emp_no LIMIT 10;
+--------+--------------+
| emp_no | record_count |
+--------+--------------+
|  10001 |           17 |
|  10002 |            6 |
|  10003 |            7 |
|  10004 |           16 |
|  10005 |           13 |
|  10006 |           12 |
|  10007 |           14 |
|  10008 |            3 |
|  10009 |           18 |
|  10010 |            6 |
+--------+--------------+
10 rows in set (0.00 sec)
```

## 2. グルーピングと集計関数

従業員番号10001から10010の従業員ごとの最小給与と最大給与を取得してください。

```sql
mysql> select emp_no ,min(salary) as '最小給与' , max(salary) as '最大給与' from salaries where emp_no BETWEEN 10001 and 10010 group by emp_no;
+--------+--------------+--------------+
| emp_no | 最小給与     | 最大給与     |
+--------+--------------+--------------+
|  10001 |        60117 |        88958 |
|  10002 |        65828 |        72527 |
|  10003 |        40006 |        43699 |
|  10004 |        40054 |        74057 |
|  10005 |        78228 |        94692 |
|  10006 |        40000 |        60098 |
|  10007 |        56724 |        88070 |
|  10008 |        46671 |        52668 |
|  10009 |        60929 |        94443 |
|  10010 |        72488 |        80324 |
+--------+--------------+--------------+
10 rows in set (0.01 sec)
```


## 3. グルーピングと集計関数2

従業員番号10001から10010の従業員ごとの勤務開始日と勤務終了日を取得してください。なお勤務中の場合、勤務終了日は 9999-01-01 となります。

```sql
mysql> select emp_no , min(from_date) as '勤務開始日' ,max(to_date) as '勤務終了日' from salaries where emp_no BETWEEN 10001 AND 10010 group by emp_no;
+--------+-----------------+-----------------+
| emp_no | 勤務開始日      | 勤務終了日      |
+--------+-----------------+-----------------+
|  10001 | 1986-06-26      | 9999-01-01      |
|  10002 | 1996-08-03      | 9999-01-01      |
|  10003 | 1995-12-03      | 9999-01-01      |
|  10004 | 1986-12-01      | 9999-01-01      |
|  10005 | 1989-09-12      | 9999-01-01      |
|  10006 | 1990-08-05      | 9999-01-01      |
|  10007 | 1989-02-10      | 9999-01-01      |
|  10008 | 1998-03-11      | 2000-07-31      |
|  10009 | 1985-02-18      | 9999-01-01      |
|  10010 | 1996-11-24      | 9999-01-01      |
+--------+-----------------+-----------------+
10 rows in set (0.00 sec)
```


## 4. 絞り込み

従業員ごとの最大給与を求め、そのうち最大給与が140,000を超えている従業員の従業員番号と最大給与を取得してください。

```sql
mysql> select emp_no , max(salary) as max_salary  from salaries group by emp_no having max_salary > 140000;
+--------+------------+
| emp_no | max_salary |
+--------+------------+
|  11486 |     145732 |
|  12149 |     141114 |
|  13386 |     144434 |
|  14487 |     144534 |
|  18006 |     144866 |
|  18997 |     145215 |
|  24099 |     141197 |
|  36219 |     148820 |
|  37558 |     149440 |
|  39964 |     142638 |
|  41822 |     146100 |
|  43624 |     158220 |
|  44188 |     140500 |
|  44465 |     146719 |
|  46439 |     150345 |
|  47286 |     140138 |
|  47978 |     155709 |
|  49232 |     141399 |
|  51531 |     142181 |
|  53402 |     146507 |
|  56012 |     141824 |
|  58746 |     142413 |
|  66793 |     150052 |
|  72680 |     140468 |
|  76125 |     141423 |
|  78008 |     144485 |
|  80823 |     154459 |
|  80937 |     142485 |
|  84052 |     142846 |
|  89825 |     143644 |
|  91935 |     147469 |
|  96957 |     143950 |
|  98169 |     144088 |
| 102078 |     140974 |
| 102962 |     146655 |
| 107140 |     142506 |
| 109334 |     155377 |
| 205000 |     153715 |
| 210661 |     145902 |
| 212558 |     140055 |
| 214842 |     143183 |
| 218237 |     141631 |
| 220051 |     142647 |
| 225306 |     144142 |
| 232753 |     147480 |
| 236748 |     141680 |
| 237069 |     140742 |
| 237542 |     152687 |
| 237674 |     145901 |
| 237694 |     141431 |
| 238117 |     152220 |
| 239311 |     143727 |
| 246120 |     146292 |
| 248492 |     143727 |
| 253939 |     155513 |
| 254247 |     142082 |
| 254466 |     156286 |
| 257360 |     144748 |
| 258761 |     146755 |
| 263955 |     146882 |
| 265296 |     142694 |
| 266526 |     152710 |
| 266639 |     142426 |
| 267069 |     141003 |
| 272431 |     145441 |
| 276633 |     152412 |
| 279776 |     150740 |
| 282030 |     142184 |
| 282370 |     141488 |
| 400122 |     144563 |
| 406747 |     142869 |
| 408988 |     144205 |
| 413137 |     142395 |
| 415751 |     146280 |
| 416972 |     140192 |
| 418416 |     141407 |
| 419748 |     140784 |
| 421835 |     141953 |
| 422084 |     144560 |
| 425675 |     142319 |
| 432583 |     143937 |
| 435435 |     144303 |
| 438507 |     140332 |
| 447240 |     140332 |
| 447849 |     145960 |
| 451883 |     140357 |
| 466852 |     145128 |
| 467956 |     142914 |
| 476883 |     141160 |
| 477358 |     140077 |
| 484736 |     141578 |
| 485205 |     141555 |
| 492164 |     148696 |
| 492633 |     143148 |
| 493158 |     154376 |
| 494128 |     141990 |
| 494152 |     140801 |
+--------+------------+
97 rows in set (0.53 sec)
```

## 5. 最小給与

従業員番号10001から10100の従業員のうち、最小給与が40,000を下回っている従業員の従業員番号とその最小給与を取得してください。

```sql
mysql> select emp_no , min(salary) as min_salary  from salaries where emp_no between 10001 and 10100 group by emp_no having min_salary < 40000;
+--------+------------+
| emp_no | min_salary |
+--------+------------+
|  10022 |      39935 |
|  10027 |      39520 |
|  10037 |      39765 |
|  10048 |      39507 |
|  10049 |      39735 |
|  10064 |      39551 |
|  10072 |      39567 |
+--------+------------+
7 rows in set (0.00 sec)
```

## 6. 最終勤務日

従業員番号10001から10100の従業員のうち、勤務が終了している従業員の従業員番号と最後の勤務終了日を取得してください。なお勤務中の場合、勤務終了日は 9999-01-01 となります。

```sql
mysql> select emp_no , to_date from salaries where emp_no between 10001 and 10100 and to_date = '9999-01-01';
+--------+------------+
| emp_no | to_date    |
+--------+------------+
|  10001 | 9999-01-01 |
|  10002 | 9999-01-01 |
|  10003 | 9999-01-01 |
|  10004 | 9999-01-01 |
|  10005 | 9999-01-01 |
|  10006 | 9999-01-01 |
|  10007 | 9999-01-01 |
|  10009 | 9999-01-01 |
|  10010 | 9999-01-01 |
|  10012 | 9999-01-01 |
|  10013 | 9999-01-01 |
|  10014 | 9999-01-01 |
|  10016 | 9999-01-01 |
|  10017 | 9999-01-01 |
|  10018 | 9999-01-01 |
|  10019 | 9999-01-01 |
|  10020 | 9999-01-01 |
|  10022 | 9999-01-01 |
|  10023 | 9999-01-01 |
|  10024 | 9999-01-01 |
|  10026 | 9999-01-01 |
|  10027 | 9999-01-01 |
|  10029 | 9999-01-01 |
|  10030 | 9999-01-01 |
|  10031 | 9999-01-01 |
|  10032 | 9999-01-01 |
|  10035 | 9999-01-01 |
|  10036 | 9999-01-01 |
|  10037 | 9999-01-01 |
|  10038 | 9999-01-01 |
|  10039 | 9999-01-01 |
|  10040 | 9999-01-01 |
|  10041 | 9999-01-01 |
|  10043 | 9999-01-01 |
|  10044 | 9999-01-01 |
|  10045 | 9999-01-01 |
|  10046 | 9999-01-01 |
|  10047 | 9999-01-01 |
|  10049 | 9999-01-01 |
|  10050 | 9999-01-01 |
|  10051 | 9999-01-01 |
|  10052 | 9999-01-01 |
|  10053 | 9999-01-01 |
|  10054 | 9999-01-01 |
|  10056 | 9999-01-01 |
|  10057 | 9999-01-01 |
|  10058 | 9999-01-01 |
|  10059 | 9999-01-01 |
|  10060 | 9999-01-01 |
|  10061 | 9999-01-01 |
|  10062 | 9999-01-01 |
|  10063 | 9999-01-01 |
|  10065 | 9999-01-01 |
|  10066 | 9999-01-01 |
|  10067 | 9999-01-01 |
|  10068 | 9999-01-01 |
|  10069 | 9999-01-01 |
|  10070 | 9999-01-01 |
|  10071 | 9999-01-01 |
|  10072 | 9999-01-01 |
|  10074 | 9999-01-01 |
|  10076 | 9999-01-01 |
|  10077 | 9999-01-01 |
|  10078 | 9999-01-01 |
|  10079 | 9999-01-01 |
|  10080 | 9999-01-01 |
|  10081 | 9999-01-01 |
|  10083 | 9999-01-01 |
|  10084 | 9999-01-01 |
|  10085 | 9999-01-01 |
|  10086 | 9999-01-01 |
|  10088 | 9999-01-01 |
|  10089 | 9999-01-01 |
|  10091 | 9999-01-01 |
|  10092 | 9999-01-01 |
|  10093 | 9999-01-01 |
|  10095 | 9999-01-01 |
|  10096 | 9999-01-01 |
|  10097 | 9999-01-01 |
|  10099 | 9999-01-01 |
|  10100 | 9999-01-01 |
+--------+------------+
81 rows in set (0.00 sec)

```